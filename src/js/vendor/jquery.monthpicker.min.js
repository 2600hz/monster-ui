/*
The jQuery UI Month Picker Version 3.0.4
https://github.com/KidSysco/jquery-ui-month-picker/

Copyright (C) 2007 Free Software Foundation, Inc. <http://fsf.org/>
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see
<http://www.gnu.org/licenses/gpl-3.0.txt>.
*/

!function(t,e,i,n){"use strict";var o="MonthPicker Error: ";if(t&&t.ui&&t.ui.button&&t.ui.datepicker){t.widget.bridge("jqueryUIButton",t.ui.button);var s=t.fx.speeds,a=".MonthPicker",r="month-picker-clear-hint",h="ui-state-highlight",u="ui-state-active",l={my:"left top+1",at:"left bottom"},c={my:"right top+1",at:"right bottom"},d=o+"The jQuery UI position plug-in must be loaded.",p=o+"Unsupported % option value, supported values are: ",_=o+'"_" is not a valid %Month value.',f=null,m=!!t.ui.position,v={Animation:["slideToggle","fadeToggle","none"],ShowAnim:["fadeIn","slideDown","none"],HideAnim:["fadeOut","slideUp","none"]},M={ValidationErrorMessage:"_createValidationMessage",Disabled:"_setDisabledState",ShowIcon:"_updateButton",Button:"_updateButton",ShowOn:"_updateFieldEvents",IsRTL:"_setRTL",AltFormat:"_updateAlt",AltField:"_updateAlt",StartYear:"_setPickerYear",MinMonth:"_setMinMonth",MaxMonth:"_setMaxMonth",SelectedMonth:"_setSelectedMonth"},k=t.noop,b=t.proxy,g=t.datepicker,Y="click"+a;t.MonthPicker={VERSION:"3.0.4",i18n:{year:"Year",prevYear:"Previous Year",nextYear:"Next Year",next12Years:"Jump Forward 12 Years",prev12Years:"Jump Back 12 Years",nextLabel:"Next",prevLabel:"Prev",buttonText:"Open Month Chooser",jumpYears:"Jump Years",backTo:"Back to",months:["Jan.","Feb.","Mar.","Apr.","May","June","July","Aug.","Sep.","Oct.","Nov.","Dec."]}};t.widget("KidSysco.MonthPicker",{options:{i18n:{},IsRTL:!1,Position:null,StartYear:null,ShowIcon:!0,UseInputMask:!1,ValidationErrorMessage:null,Disabled:!1,MonthFormat:"mm/yy",Animation:"fadeToggle",ShowAnim:null,HideAnim:null,ShowOn:null,MinMonth:null,MaxMonth:null,Duration:"normal",Button:function(e){return t('<span id="MonthPicker_Button_'+this.id+'" class="month-picker-open-button">'+e.i18n.buttonText+"</span>").jqueryUIButton({text:!1,icons:{primary:e.ButtonIcon}})},ButtonIcon:"ui-icon-calculator"},_monthPickerButton:t(),_validationMessage:t(),_selectedBtn:t(),_destroy:function(){var e=this.element;t.mask&&this.options.UseInputMask&&(e.unmask(),this.GetSelectedDate()||e.val("")),e.removeClass("month-year-input").off(a),t(i).off(a+this.uuid),this._monthPickerMenu.remove();var n=this._monthPickerButton.off(Y);this._removeOldBtn&&n.remove(),this._validationMessage.remove(),f===this&&(f=null)},_setOption:function(e,i){switch(e){case"i18n":i=t.extend({},i);break;case"Position":if(!m)return void alert(d);break;case"MonthFormat":var n=this.GetSelectedDate();n&&this.element.val(this.FormatMonth(n,i))}e in v&&-1===t.inArray(i,v[e])?alert(p.replace(/%/,e)+v[e]):(this._super(e,i),M[e]&&this[M[e]](i))},_create:function(){var e=this.element,s=this.options,r=e.attr("type");if(!e.is("input,div,span")||"text"!==r&&"month"!==r&&void 0!==r){var h=o+"MonthPicker can only be called on text or month inputs.";return alert(h+" \n\nSee (developer tools) for more details."),console.error(h+"\n Caused by:"),console.log(e[0]),!1}if(!t.mask&&s.UseInputMask)return alert(o+"The UseInputMask option requires the Input Mask Plugin. Get it from digitalbush.com"),!1;if(null!==s.Position&&!m)return alert(d),!1;for(var u in v)if(null!==s[u]&&-1===t.inArray(s[u],v[u]))return alert(p.replace(/%/,u)+v[u]),!1;this._isMonthInputType="month"===e.attr("type"),this._isMonthInputType&&(this.options.MonthFormat=this.MonthInputFormat,e.css("width","auto"));var l=this._monthPickerMenu=t('<div id="MonthPicker_'+e[0].id+'" class="month-picker ui-widget ui-widget-content ui-corner-all"></div>').hide(),c=C(e);t('<div class="ui-widget-header month-picker-header ui-corner-all"><table class="month-picker-year-table"><tr><td class="month-picker-previous"><a /></td><td class="month-picker-title"><a /></td><td class="month-picker-next"><a /></td></tr></table></div><div><table class="month-picker-month-table" /></div>').appendTo(l),l.appendTo(c?e:i.body),this._titleButton=t(".month-picker-title",l).click(b(this._showYearsClickHandler,this)).find("a").jqueryUIButton().removeClass("ui-state-default"),this._applyJumpYearsHint(),this._createValidationMessage(),this._prevButton=t(".month-picker-previous>a",l).jqueryUIButton({text:!1}).removeClass("ui-state-default"),this._nextButton=t(".month-picker-next>a",l).jqueryUIButton({text:!1}).removeClass("ui-state-default"),this._setRTL(s.IsRTL),t(".ui-button-icon-primary",this._nextButton).text(this._i18n("nextLabel")),t(".ui-button-icon-primary",this._prevButton).text(this._i18n("prevLabel"));for(var f=t(".month-picker-month-table",l),M=0;M<12;M++){var k=M%3?k:t("<tr />").appendTo(f);k.append('<td><a class="button-'+(M+1)+'" /></td>')}this._buttons=t("a",f).jqueryUIButton(),l.on("mousedown"+a,function(t){t.preventDefault()});var g=this;t.each(["Min","Max"],function(t,e){g["_set"+e+"Month"]=function(t){!1===(g["_"+e+"Month"]=I(g,t))&&alert(_.replace(/%/,e).replace(/_/,t))},g._setOption(e+"Month",g.options[e+"Month"])});var Y=s.SelectedMonth;if(void 0!==Y){var y=I(this,Y);e.val(this._formatMonth(new n(B(y),y%12,1)))}this._updateAlt(),this._setUseInputMask(),this._setDisabledState(),this.Destroy=this.destroy,c?this.Open():(e.addClass("month-year-input"),e.change(b(this._updateAlt,this)))},GetSelectedDate:function(){return this._parseMonth()},GetSelectedYear:function(){var t=this.GetSelectedDate();return t?t.getFullYear():NaN},GetSelectedMonth:function(){var t=this.GetSelectedDate();return t?t.getMonth()+1:NaN},Validate:function(){var t=this.GetSelectedDate();return null===this.options.ValidationErrorMessage||this.options.Disabled||this._validationMessage.toggle(!t),t},GetSelectedMonthYear:function(){var t=this.Validate();return t?t.getMonth()+1+"/"+t.getFullYear():null},Disable:function(){this._setOption("Disabled",!0)},Enable:function(){this._setOption("Disabled",!1)},ClearAllCallbacks:function(){for(var t in this.options)0===t.indexOf("On")&&(this.options[t]=k)},Clear:function(){this.element.val(""),t(this.options.AltField).val(""),this._validationMessage.hide()},Toggle:function(t){return this._visible?this.Close(t):this.Open(t)},Open:function(e){var n=this.element,o=this.options;if(!o.Disabled&&!this._visible){if(e=e||t.Event(),!1===T("OnBeforeMenuOpen",this)(e)||e.isDefaultPrevented())return;this._visible=!0,this._ajustYear(o);var s=this._monthPickerMenu;if(this._showMonths(),C(n))s.css("position","static").show(),T("OnAfterMenuOpen",this)();else{f&&f.Close(e),f=this,t(i).on("mousedown"+a+this.uuid,b(this.Close,this)).on("keydown"+a+this.uuid,b(this._keyDown,this)),n.off("blur"+a).focus();var r=o.ShowAnim||o.Animation,h="none"===r;s[h?"fadeIn":r]({duration:h?0:this._duration(),start:b(this._position,this,s),complete:T("OnAfterMenuOpen",this)})}}},Close:function(e){var n=this.element;if(!C(n)&&this._visible){var o=this._monthPickerMenu,s=this.options;if(e=e||t.Event(),!1===T("OnBeforeMenuClose",this)(e)||e.isDefaultPrevented())return;this._backToYear&&(this._applyJumpYearsHint(),this._backToYear=0),this._visible=!1,f=null,t(i).off("keydown"+a+this.uuid).off("mousedown"+a+this.uuid),this.Validate(),n.on("blur"+a,b(this.Validate,this));var r=T("OnAfterMenuClose",this),h=s.HideAnim||s.Animation;"none"===h?o.hide(0,r):o[h](this._duration(),r)}},MonthInputFormat:"yy-mm",ParseMonth:function(t,e){try{return g.parseDate("dd"+e,"01"+t)}catch(t){return null}},FormatMonth:function(t,e){try{return g.formatDate(e,t)||null}catch(t){return null}},_setSelectedMonth:function(t){var e=I(this,t),i=this.element;if(e){var o=new n(B(e),e%12,1);i.val(this._formatMonth(o)),this._updateAlt(0,o),this._validationMessage.hide()}else this.Clear();this._ajustYear(this.options),this._showMonths()},_applyJumpYearsHint:function(){!function(e,i){var n,o,s=125,h=t();function u(){o=null,h=t("span",e).animate({opacity:.45},s,l)}function l(){n=h.text(),h.animate({opacity:1},s).text(i)}function c(){h.text(n).animate({opacity:1},s)}e.on("mouseenter"+a+"h",function(){o=setTimeout(u,175)}),e.on("mouseleave"+a+"h",function(){o?clearTimeout(o):h=t("span",e).animate({opacity:.45},s,c)}),e.data(r,function(){clearTimeout(o),h.stop().css({opacity:1}),e.off(a+"h")})}(this._titleButton,this._i18n("jumpYears"))},_i18n:function(e){var i=this.options.i18n[e];return void 0===i?t.MonthPicker.i18n[e]:i},_parseMonth:function(t,e){return this.ParseMonth(t||this.element.val(),e||this.options.MonthFormat)},_formatMonth:function(t,e){return this.FormatMonth(t||this._parseMonth(),e||this.options.MonthFormat)},_updateButton:function(){var t=this.options.Disabled;this._createButton();var e=this._monthPickerButton;try{e.jqueryUIButton("option","disabled",t)}catch(i){e.filter("button,input").prop("disabled",t)}this._updateFieldEvents()},_createButton:function(){var e=this.element,n=this.options;if(!C(e)){var o=this._monthPickerButton.off(a),s=!!n.ShowIcon&&n.Button;if(t.isFunction(s)){var r=t.extend(!0,{i18n:t.extend(!0,{},t.MonthPicker.i18n)},this.options);s=s.call(e[0],r)}var h=!1;this._monthPickerButton=(s instanceof t?s:t(s)).each(function(){t.contains(i.body,this)||(h=!0,t(this).insertAfter(e))}).on(Y,b(this.Toggle,this)).on("mousedown"+a,function(t){t.preventDefault()}),this._removeOldBtn&&o.remove(),this._removeOldBtn=h}},_updateFieldEvents:function(){var t=Y+" focus"+a;this.element.off(t),"both"!==this.options.ShowOn&&this._monthPickerButton.length||this.element.on(t,b(this.Open,this))},_createValidationMessage:function(){var e=this.options.ValidationErrorMessage,i=this.element;if(-1===t.inArray(e,[null,""])){var n=t('<span id="MonthPicker_Validation_'+i[0].id+'" class="month-picker-invalid-message">'+e+"</span>"),o=this._monthPickerButton;this._validationMessage=n.insertAfter(o.length?o:i),i.on("blur"+a,b(this.Validate,this))}else this._validationMessage.remove()},_setRTL:function(t){A(this._prevButton.css("float",t?"right":"left"),!t),A(this._nextButton.css("float",t?"left":"right"),t)},_keyDown:function(t){switch(t.keyCode){case 13:this.element.val()||this._chooseMonth((new n).getMonth()+1),this.Close(t);break;case 27:case 9:this.Close(t)}},_duration:function(){var e=this.options.Duration;return t.isNumeric(e)?e:e in s?s[e]:s._default},_position:m?function(e){var i=this.options.IsRTL?c:l,n=t.extend(i,this.options.Position);return e.position(t.extend({of:this.element},n))}:function(t){var e=this.element,i={top:e.offset().top+e.height()+7+"px"};return this.options.IsRTL?i.left=e.offset().left-t.width()+e.width()+7+"px":i.left=e.offset().left+"px",t.css(i)},_setUseInputMask:function(){if(!this._isMonthInputType)try{this.options.UseInputMask?this.element.mask(this._formatMonth(new n).replace(/\d/g,9)):this.element.unmask()}catch(t){}},_setDisabledState:function(){var t=this.options.Disabled,e=this.element;e[0].disabled=t,e.toggleClass("month-picker-disabled",t),t&&this._validationMessage.hide(),this.Close(),this._updateButton(),T("OnAfterSetDisabled",this)(t)},_getPickerYear:function(){return this._pickerYear},_setPickerYear:function(t){this._pickerYear=t||(new n).getFullYear(),this._titleButton.jqueryUIButton({label:this._i18n("year")+" "+this._pickerYear})},_updateAlt:function(e,i){var n=t(this.options.AltField);n.length&&n.val(this._formatMonth(i,this.options.AltFormat))},_chooseMonth:function(e){var i=this._getPickerYear(),o=new n(i,e-1);this.element.val(this._formatMonth(o)).blur(),this._updateAlt(0,o),x(this._selectedBtn,!1),this._selectedBtn=x(t(this._buttons[e-1]),!0),T("OnAfterChooseMonth",this)(o)},_chooseYear:function(t){this._backToYear=0,this._setPickerYear(t),this._buttons.removeClass(h),this._showMonths(),this._applyJumpYearsHint(),T("OnAfterChooseYear",this)()},_showMonths:function(){var e=this._i18n("months");this._prevButton.attr("title",this._i18n("prevYear")).off(Y).on(Y,b(this._addToYear,this,-1)),this._nextButton.attr("title",this._i18n("nextYear")).off(Y).on(Y,b(this._addToYear,this,1)),this._buttons.off(a);var i=this,n=b(i._onMonthClick,i);t.each(e,function(e,o){t(i._buttons[e]).on(Y,{month:e+1},n).jqueryUIButton("option","label",o)}),this._decorateButtons()},_showYearsClickHandler:function(){if(this._buttons.removeClass(h),this._backToYear)this._setPickerYear(this._backToYear),this._applyJumpYearsHint(),this._showMonths(),this._backToYear=0;else{this._backToYear=this._getPickerYear(),this._showYears();var t=this._i18n("backTo")+" "+this._getPickerYear();this._titleButton.jqueryUIButton({label:t}).data(r)(),T("OnAfterChooseYears",this)()}},_showYears:function(){var e=this._getPickerYear(),i=-4,o=e+i,s=(new n).getFullYear(),r=this._MinMonth,u=this._MaxMonth,l=r?B(r):0,c=u?B(u):0;this._prevButton.attr("title",this._i18n("prev12Years")).off(Y).on(Y,b(this._addToYears,this,-12)),this._nextButton.attr("title",this._i18n("next12Years")).off(Y).on(Y,b(this._addToYears,this,12)),S(this._prevButton,l&&o-1<l),S(this._nextButton,c&&o+12-1>c),this._buttons.off(a),x(this._selectedBtn,!1);for(var d=this.GetSelectedYear(),p=b(this._onYearClick,this),_=P(s,l,c),f=P(d,l,c),m=0;m<12;m++){var v=e+i,M=t(this._buttons[m]).jqueryUIButton({disabled:!P(v,l,c),label:v}).toggleClass(h,v===s&&_).on(Y,{year:v},p);f&&d&&d===v&&(this._selectedBtn=x(M,!0)),i++}},_onMonthClick:function(t){this._chooseMonth(t.data.month),this.Close(t)},_onYearClick:function(t){this._chooseYear(t.data.year)},_addToYear:function(t){this._setPickerYear(this._getPickerYear()+t),this.element.focus(),this._decorateButtons(),T("OnAfter"+(t>0?"Next":"Previous")+"Year",this)()},_addToYears:function(t){this._pickerYear=this._getPickerYear()+t,this._showYears(),this.element.focus(),T("OnAfter"+(t>0?"Next":"Previous")+"Years",this)()},_ajustYear:function(t){var e=t.StartYear||this.GetSelectedYear()||(new n).getFullYear();null!==this._MinMonth&&(e=Math.max(B(this._MinMonth),e)),null!==this._MaxMonth&&(e=Math.min(B(this._MaxMonth),e)),this._setPickerYear(e)},_decorateButtons:function(){var e=this._getPickerYear(),i=y(new n),o=this._MinMonth,s=this._MaxMonth;x(this._selectedBtn,!1);var a=this.GetSelectedDate(),r=P(a?y(a):null,o,s);a&&a.getFullYear()===e&&(this._selectedBtn=x(t(this._buttons[a.getMonth()]),r)),S(this._prevButton,o&&e==B(o)),S(this._nextButton,s&&e==B(s));for(var u=0;u<12;u++){var l=12*e+u,c=P(l,o,s);t(this._buttons[u]).jqueryUIButton({disabled:!c}).toggleClass(h,c&&l==i)}}})}else alert(o+"The jQuery UI button and datepicker plug-ins must be loaded.");function y(t){return t.getMonth()+12*t.getFullYear()}function B(t){return Math.floor(t/12)}function w(){t(this).addClass(u)}function x(t,e){return t[e?"on":"off"]("mousenter mouseout",w).toggleClass(u,e)}function P(t,e,i){return(!e||t>=e)&&(!i||t<=i)}function I(e,i){if(null===i)return i;if(i instanceof n)return y(i);if(t.isNumeric(i))return y(new n)+parseInt(i,10);var o=e._parseMonth(i);return o?y(o):function(e,i){var o=t.trim(e);o=(o=o.replace(/y/i,'":"y"')).replace(/m/i,'":"m"');try{var s=JSON.parse('{"'+o.replace(/ /g,',"')+"}"),a={};for(var r in s)a[s[r]]=r;var h=y(new n);return(h+=parseInt(a.m,10)||0)+12*(parseInt(a.y,10)||0)}catch(t){return!1}}(i)}function T(t,e){return b(e.options[t]||k,e.element[0])}function A(t,e){t.jqueryUIButton("option",{icons:{primary:"ui-icon-circle-triangle-"+(e?"w":"e")}})}function C(t){return!t.is("input")}function S(t,e){var i=t.data("ui-button");i.option("disabled")!==e&&i.option("disabled",e)}}(jQuery,window,document,Date);
